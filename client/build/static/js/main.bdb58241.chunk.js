(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{269:function(e,t,a){e.exports=a(535)},360:function(e,t,a){},361:function(e,t,a){},362:function(e,t,a){},527:function(e,t,a){},534:function(e,t,a){},535:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(7),o=a.n(l),s=(a(360),a(19)),i=a(21),c=a(23),m=a(22),u=a(24),d=a(185),h=a(537),p=a(543),f=a(133),g=a(11),b=(a(361),a(265)),v=function e(t){var a=this;Object(s.a)(this,e),this.login=function(e,t){return a.fetch("".concat(a.domain,"/admin/login"),{method:"POST",body:JSON.stringify({userName:e,password:t})}).then(function(e){return a.setToken(e.msg),a.setUserName(e.data.userName),console.log(a.getToken()),console.log(a.getUserName()),Promise.resolve(e)})},this.isLoggedIn=function(){return!!a.getToken()},this.setUserName=function(e){localStorage.setItem("currentUser",e)},this.getUserName=function(){return localStorage.getItem("currentUser")},this.setToken=function(e){localStorage.setItem("id_token",e)},this.getToken=function(){return localStorage.getItem("id_token")},this.logout=function(){return localStorage.removeItem("id_token")},this.getConfirm=function(){var e=a.getToken();return console.log("Recieved answer!"),e},this.fetch=function(e,t){var n={Accept:"application/json","Content-Type":"application/json"};return a.isLoggedIn()&&(n.Authorization=+a.getToken()),fetch(e,Object(b.a)({headers:n},t)).then(a._checkStatus).then(function(e){return e.json()})},this._checkStatus=function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t},this.domain=t||"https://iotwatersystemserver.herokuapp.com/iot"},y=a(134),E=a(104),w=a(539),C=a(541),N=a(38),k=(a(362),a(31)),O=a.n(k),S=a(124),M=a.n(S),j=E.a.Option,D=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).Auth=new v,a.state={userName:"",oldPwd:"",newPwd:""},a.success=function(){p.a.success("Update success!")},a.onChangeUserName=function(e){console.log("selected ".concat(e)),a.setState({userName:e})},a.onChangeOldPwd=function(e){a.setState({oldPwd:e.target.value})},a.onChangeNewPwd=function(e){a.setState({newPwd:e.target.value})},a.handleChangePw=function(e){e.preventDefault();var t=M.a.stringify({userName:a.state.userName,oldPwd:a.state.oldPwd,newPwd:a.state.newPwd});console.log(t),O.a.post("http://localhost:8080/iot/admin/updatePassword",t).then(function(e){if(200!==e.data.code)return alert(e.data.msg);console.log(e.data.code),a.props.history.push("/"+a.state.userName),a.success()}).catch(function(e){console.log(e),alert("Failure change password")}),a.props.form.validateFields(function(e,t){e||console.log("Received values of form: ",t)})},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement("div",{className:"ant-form"},r.a.createElement(w.a,{onSubmit:this.handleChangePw,className:"login-form"},r.a.createElement(w.a.Item,null,e("userName",{rules:[{required:!0,message:"Please select person!"}]})(r.a.createElement(E.a,{showSearch:!0,style:{width:200},placeholder:"Select a person",optionFilterProp:"children",onChange:this.onChangeUserName,filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},r.a.createElement(j,{value:"admin"},"Admin"),r.a.createElement(j,{value:"member"},"Member")))),r.a.createElement(w.a.Item,null,e("oldPwd",{rules:[{required:!0,message:"Please input your old Password!"}]})(r.a.createElement(C.a,{prefix:r.a.createElement(g.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"old Password",style:{width:"200px"},onChange:this.onChangeOldPwd}))),r.a.createElement(w.a.Item,null,e("newPwd",{rules:[{required:!0,message:"Please input your new Password!"},{min:4,message:"At least 4 digits!"}]})(r.a.createElement(C.a,{prefix:r.a.createElement(g.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"new Password",style:{width:"200px"},onChange:this.onChangeNewPwd}))),r.a.createElement(N.a,{type:"primary",htmlType:"submit",className:"login-form-button",style:{width:"200px"}},"Change password")))}}]),t}(r.a.Component),I=w.a.create({name:"normal_login"})(D),x=a(66),R=a(59),L=a(542),P=a(536),A=a(538),F=w.a.create({name:"form_in_modal"})(function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={disabled:!0,visible:!1},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.handleSubmit,l=e.form.getFieldDecorator;return r.a.createElement(L.a,{visible:t,title:"Edit Form",okText:"OK",onCancel:a,onOk:n},r.a.createElement(w.a,{layout:"vertical"},r.a.createElement(w.a.Item,{label:"ID"},l("mid",{rules:[{required:!0,message:"Please input meter name!"}]})(r.a.createElement(C.a,{disabled:this.state.disabled}))),r.a.createElement(w.a.Item,{label:"Meter Name"},l("meterName",{rules:[{required:!0,message:"Please input meter name!"},{max:10,message:"Please input correct meter name!"}]})(r.a.createElement(C.a,null))),r.a.createElement(w.a.Item,{label:"Descriptions"},l("meterDesc",{rules:[{required:!0,message:"Please input descriptions!"},{max:30,message:"Max 30 digits!"}]})(r.a.createElement(C.a,null))),r.a.createElement(w.a.Item,{label:"Member Name"},l("memberName",{rules:[{required:!0,message:"Please input member name!"},{max:15,message:"Incorrect format!"}]})(r.a.createElement(C.a,null))),r.a.createElement(w.a.Item,{label:"Room Number"},l("room",{rules:[{required:!0,message:"Please input room number!"},{max:5,message:"Invild room number!"}]})(r.a.createElement(C.a,null))),r.a.createElement(w.a.Item,{label:"Member Contact"},l("memberContact",{rules:[{required:!0,message:"Please input member contact!"},{type:"email",message:"The input is not valid E-mail!"}]})(r.a.createElement(C.a,null)))))}}]),t}(n.Component)),T=w.a.create({name:"form_in_modal"})(function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.handleSubmit,l=e.form.getFieldDecorator;return r.a.createElement(L.a,{visible:t,title:"Create Form",okText:"OK",onCancel:a,onOk:n},r.a.createElement(w.a,{layout:"vertical"},r.a.createElement(w.a.Item,{label:"Meter Name"},l("meterName",{rules:[{required:!0,message:"Please input meter name!"},{max:10,message:"Please input correct meter name!"}]})(r.a.createElement(C.a,null))),r.a.createElement(w.a.Item,{label:"Descriptions"},l("meterDesc",{rules:[{required:!0,message:"Please input descriptions!"},{max:30,message:"Max 30 digits!"}]})(r.a.createElement(C.a,null))),r.a.createElement(w.a.Item,{label:"Member Name"},l("memberName",{rules:[{required:!0,message:"Please input member name!"},{max:15,message:"Incorrect format!"}]})(r.a.createElement(C.a,null))),r.a.createElement(w.a.Item,{label:"Room Number"},l("room",{rules:[{required:!0,message:"Please input room number!"},{max:5,message:"Invild room number!"}]})(r.a.createElement(C.a,null))),r.a.createElement(w.a.Item,{label:"Member Contact(Email)"},l("memberContact",{rules:[{required:!0,message:"Please input member contact!"},{type:"email",message:"The input is not valid E-mail!"}]})(r.a.createElement(C.a,null)))))}}]),t}(n.Component)),W=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).Auth=new v,a.state={visible:!1},a.error=function(){p.a.error("Add Fail")},a.showModal=function(){a.setState({visible:!0})},a.handleCancel=function(){a.setState({visible:!1})},a.createSuccess=function(){p.a.success("Create success!")},a.handleCreate=function(){var e=a.formRef.props.form,t=e.getFieldsValue(),n={meterDesc:t.meterDesc,meterName:t.meterName,memberName:t.memberName,room:t.room,memberContact:t.memberContact};e.validateFields(function(t,n){t||(console.log("Received values of form: ",n),a.setState({visible:!1}),e.resetFields())}),O.a.post("/meter/addMeter",n).then(function(e){if(200!==e.data.code)return a.error();a.props.coolName(e),a.createSuccess()}).catch(function(e){console.log(e),a.error()})},a.saveFormRef=function(e){a.formRef=e},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(N.a,{type:"primary",onClick:this.showModal,style:{marginTop:6}},"Create Meter"),r.a.createElement(T,{wrappedComponentRef:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,handleSubmit:this.handleCreate}))}}]),t}(n.Component),U=L.a.confirm,B={"Content-Type":"application/x-www-form-urlencoded"},q=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).Auth=new v,a.state={memberList:[]},a.error=function(){p.a.error("Opreating Fail")},a.showBill=function(){a.props.history.push("/waterbill")},a.showRealTime=function(){a.props.history.push("/SensorData")},a.showEditMoal=function(e){var t=a.formRef.props.form;t.memberList=e,console.log(e.mid);var n=t.memberList;console.log(n);var r={mid:e.mid,meterName:e.meterName,meterDesc:e.meterDesc,memberName:e.memberName,room:e.room,memberContact:e.memberContact};t.setFieldsValue(r),a.setState({visible:!0})},a.handleCancel=function(){a.setState({visible:!1})},a.updateSuccess=function(){p.a.success("Update success")},a.deleteSuccess=function(){p.a.success("Delete success!")},a.handleUpdate=function(){var e=a.formRef.props.form,t=e.getFieldsValue();console.log(t.mid);var n={mid:t.mid,meterName:t.meterName,meterDesc:t.meterDesc,room:t.room,memberContact:t.memberContact,memberName:t.memberName};console.log(n),e.validateFields(function(t,n){t||(console.log("Received values of form: ",n),e.resetFields(),a.setState({visible:!1}))}),O.a.post("/meter/update",n).then(function(e){if(console.log(e.data.code),200!==e.data.code)return a.error();a.fetchMemberList(),a.updateSuccess(),console.log(e)}).catch(function(e){console.log(e),a.error()})},a.saveFormRef=function(e){a.formRef=e},a.deleteMember=function(e){var t={mid:e};console.log(t),O.a.delete("/meter/delete",{params:t},{headers:B}).then(function(t){a.setState({memberList:a.state.memberList.filter(function(t){return t.mid!==e})}),a.deleteSuccess(),console.log(t)}).catch(function(e){console.log(e),a.error()})},a.fetchMemberList=function(){O.a.get("/meter/getMeters").then(function(e){console.log(e.data.data),a.setState({memberList:e.data.data}),console.log(a.Auth.getToken())}).catch(function(e){console.log(e)})},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"showDeleteConfirm",value:function(e,t){var a=this;console.log(e),U({title:"Are you sure delete ".concat(t,"?"),okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){a.deleteMember(e),console.log("OK")},onCancel:function(){console.log("Cancel")}})}},{key:"componentDidMount",value:function(){this.fetchMemberList()}},{key:"render",value:function(){var e=this,t=[{title:"Meter Name",dataIndex:"meterName"},{title:"Descriptions",dataIndex:"meterDesc"},{title:"Member Name",dataIndex:"memberName"},{title:"Room",dataIndex:"room"},{title:"Member Contact",dataIndex:"memberContact"},{title:"Action",key:"action",render:function(t){return r.a.createElement("span",null,r.a.createElement(N.a,{size:"small",onClick:function(){return e.showEditMoal(t)}},"Edit"),r.a.createElement(P.a,{type:"vertical"}),r.a.createElement(N.a,{size:"small",onClick:function(){return e.showDeleteConfirm(t.mid,t.meterName)},type:"danger"},"Delete"),r.a.createElement(P.a,{type:"vertical"}),r.a.createElement(N.a,{type:"primary",size:"small",onClick:e.showRealTime},"View Data"),r.a.createElement(P.a,{type:"vertical"}),r.a.createElement(R.b,{to:"/report/"+t.meterName},"View Report"),r.a.createElement(P.a,{type:"vertical"}),r.a.createElement(N.a,{type:"primary",size:"small",onClick:e.showBill},"Water Bill"))}}],a=this.state.memberList;return r.a.createElement("div",null,r.a.createElement(W,{coolName:this.fetchMemberList}),r.a.createElement("br",null),r.a.createElement(A.a,{rowKey:function(e){return e.mid},columns:t,dataSource:a}),r.a.createElement(F,{wrappedComponentRef:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,handleSubmit:this.handleUpdate}))}}]),t}(n.Component),V=a(540),_=a(35),z=new Date,K=z.getDate(),J=z.getMonth(),G=z.getFullYear()+"-"+(J+1)+"-"+K,H=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={dayData:[],weekData:[],monthData:[]},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getDailyReport(),this.getWeeklyReport(),this.getMonthlyReport()}},{key:"getDailyReport",value:function(){var e=this;O.a.get("http://localhost:8080/iot/data/getDailyData?meterName=Sensor-1&date=2019-7-3").then(function(t){200===t.data.code&&e.setState({dayData:t.data.data}),console.log(G)}).catch(function(e){console.log(e)})}},{key:"getWeeklyReport",value:function(){var e=this;O.a.get("http://localhost:8080/iot/data/getWeeklyData?meterName=Sensor-1&date=2019-7-3").then(function(t){200===t.data.code&&e.setState({weekData:t.data.data})}).catch(function(e){console.log(e)})}},{key:"getMonthlyReport",value:function(){var e=this;O.a.get("http://localhost:8080/iot/data/getMonthlyData?meterName=Sensor-1&date=".concat(G)).then(function(t){200===t.data.code&&e.setState({monthData:t.data.data})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this.state.dayData,t=this.state.weekData,a=this.state.monthData;return r.a.createElement("div",null,r.a.createElement(V.a,{title:"Water report"},r.a.createElement("p",{style:{fontSize:14,color:"rgba(0, 0, 0, 0.85)",marginBottom:16,fontWeight:500}}),r.a.createElement(V.a,{type:"inner",title:"Daliy report"},r.a.createElement(_.Chart,{height:400,data:e,scale:{totalMilliters:{tickInterval:1500}},forceFit:!0},r.a.createElement(_.Axis,{name:"hour"}),r.a.createElement(_.Axis,{name:"totalMilliters"}),r.a.createElement(_.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(_.Geom,{type:"interval",position:"hour*totalMilliters"}))),r.a.createElement(V.a,{type:"inner",title:"Weekly report"},r.a.createElement(_.Chart,{height:500,data:t,scale:{totalMilliters:{tickInterval:2e3}},forceFit:!0},r.a.createElement(_.Axis,{name:"week"}),r.a.createElement(_.Axis,{name:"totalMilliters"}),r.a.createElement(_.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(_.Geom,{type:"interval",position:"week*totalMilliters"}))),r.a.createElement(V.a,{type:"inner",title:"Monthly report"},r.a.createElement(_.Chart,{height:500,data:a,scale:{totalMilliters:{tickInterval:3e3}},forceFit:!0},r.a.createElement(_.Axis,{name:"day"}),r.a.createElement(_.Axis,{name:"totalMilliters"}),r.a.createElement(_.Tooltip,{crosshairs:{type:"y"}}),r.a.createElement(_.Geom,{type:"interval",position:"day*totalMilliters"})))))}}]),t}(n.Component),Z=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={waterBill:[]},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getWaterBill()}},{key:"getWaterBill",value:function(){var e=this;O.a.get("http://localhost:8080/iot/meter/getWaterBill").then(function(t){var a=["January","February","March","April","May","June","July","August","September","October","November","December"][t.data.data[0].month-1]||"";console.log(a),200===t.data.code&&e.setState({waterBill:t.data.data})}).catch(function(e){console.log(e)})}},{key:"render",value:function(){var e=this.state.waterBill;return r.a.createElement(A.a,{rowKey:function(e){return e.memberName},columns:[{title:"Meter Name",dataIndex:"meterName"},{title:"Member Name",dataIndex:"memberName"},{title:"Month",dataIndex:"month"},{title:"Amount volume (totalMilliters /mL)",dataIndex:"totalMilliters"},{title:"Amount Fee(Bath)",dataIndex:"fee"}],dataSource:e,bordered:!0,title:function(){return"Water Bill"},footer:function(){return"25Bath per unit,one unit is 1000mL"}})}}]),t}(r.a.Component),Y=a(544),Q=w.a.create({name:"form_in_modal"})(function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.onCancel,n=e.onCreate,l=e.form.getFieldDecorator;return r.a.createElement(L.a,{visible:t,title:"Set up water volume",okText:"Setup",onCancel:a,onOk:n},r.a.createElement(w.a,{layout:"vertical"},r.a.createElement(w.a.Item,{label:"Member Name"},l("memberName",{rules:[{required:!0,message:"Please input meter name!"}]})(r.a.createElement(C.a,null))),r.a.createElement(w.a.Item,{label:"Volume (mL)"},l("volume",{rules:[{required:!0,message:"Please input water volume!"}]})(r.a.createElement(C.a,null)))),r.a.createElement(Y.a,{color:"magenta",style:{marginBottom:15}},"Do you know ?"),r.a.createElement(V.a,{style:{width:472}},r.a.createElement("p",null,r.a.createElement("b",null,"1."),"Toilet flush: 126 litres (two flushes per day; the rest of the time use grey water)"),r.a.createElement("p",null,r.a.createElement("b",null,"2."),"Washing hands: 25.2 litres (12 times per day, on average)"),r.a.createElement("p",null,r.a.createElement("b",null,"3."),"Brushing teeth: 5.6 litres (twice per day)"),r.a.createElement("p",null,r.a.createElement("b",null,"4."),"Bath: 50 litres (1 half-full bath per week, which includes water for rinsing hair. Washing your hair once a week may be less than you or your hair type can tolerate but it\u2019s perfectly hygienic.)"),r.a.createElement("p",null,r.a.createElement("b",null,"5."),"Sponge bath: 1.8 litres (six times per week. Sponge baths are also hygienic if done properly: it\u2019s how patients are washed in hospital. Make sure you keep your washcloths/sponges scrupulously clean, and use a fresh one every time you wash.)"),r.a.createElement("p",null,r.a.createElement("b",null,"6."),"Handwashing dishes: 63 litres (3.5 sink-loads per week)"),r.a.createElement("p",null,r.a.createElement("b",null,"7."),"Dishwasher: 29 litres (one load per week)"),r.a.createElement("p",null,r.a.createElement("b",null,"8."),"Washing machine: 112.5 litres (1.5 loads per week)"),r.a.createElement("p",null,r.a.createElement("b",null,"9."),"Cooking: 7 litres (average one litre per day)"),r.a.createElement("p",null,r.a.createElement("b",null,"10."),"Water for tea/coffee: 4.2 litres (average three cups per day)"),r.a.createElement("p",null,r.a.createElement("b",null,"11."),"Refilling pet water bowl: 6.3 litres (three cat bowls per day)"),r.a.createElement("p",null,r.a.createElement("b",null,"12."),"Dripping tap: 35 litres"),r.a.createElement("p",null,r.a.createElement("b",null,"TOTAL = 465.6 litres per week OR 66.5 litres per day"))))}}]),t}(r.a.Component)),$=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={visible:!1},a.error=function(){p.a.error("Set up volume fail!")},a.showModal=function(){a.setState({visible:!0})},a.handleCancel=function(){a.setState({visible:!1})},a.createSuccess=function(){p.a.success("Set up volume success!")},a.handleCreate=function(){var e=a.formRef.props.form,t=e.getFieldsValue(),n=M.a.stringify({memberName:t.memberName,volume:t.volume});console.log(n),e.validateFields(function(t,n){t||(console.log("Received values of form: ",n),e.resetFields(),a.setState({visible:!1}))}),O.a.post("http://localhost:8080/iot/meter/setMemberVolume",n).then(function(e){if(console.log(e.data),200!==e.data.code)return alert(e.data.msg);a.createSuccess()})},a.saveFormRef=function(e){a.formRef=e},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(N.a,{type:"primary",onClick:this.showModal},"Setup Volume"),r.a.createElement(Q,{wrappedComponentRef:this.saveFormRef,visible:this.state.visible,onCancel:this.handleCancel,onCreate:this.handleCreate}))}}]),t}(r.a.Component),X=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={memberList:[]},a.showBill=function(){a.props.history.push("/waterbill")},a.showRealTime=function(){a.props.history.push("/sensorData")},a.fetchMemberList=function(){O.a.get("http://localhost:8080/iot/meter/getMeters").then(function(e){a.setState({memberList:e.data.data})}).catch(function(e){console.log(e)})},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.fetchMemberList()}},{key:"render",value:function(){var e=this,t=[{title:"Meter Name",dataIndex:"meterName"},{title:"Descriptions",dataIndex:"meterDesc"},{title:"Member Name",dataIndex:"memberName"},{title:"Room",dataIndex:"room"},{title:"Action",key:"action",render:function(t){return r.a.createElement("span",null,r.a.createElement(N.a,{type:"primary",size:"small",onClick:e.showRealTime},"View Data"),r.a.createElement(P.a,{type:"vertical"}),r.a.createElement(N.a,{type:"primary",size:"small",onClick:e.showBill},"Water Bill"),r.a.createElement(P.a,{type:"vertical"}),r.a.createElement(R.b,{to:"/report/"+t.mid},"View Report"))}}],a=this.state.memberList;return r.a.createElement("div",null,r.a.createElement($,null),r.a.createElement(A.a,{rowKey:function(e){return e.mid},columns:t,dataSource:a}))}}]),t}(r.a.Component),ee=(a(527),y.a.Group),te=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).Auth=new v,a.state={userName:"",password:""},a.error=function(){p.a.error("Invalid Account")},a.success=function(){p.a.success("Login Success!")},a.onChangeRadio=function(e){console.log("radio checked",e.target.value),a.setState({userName:e.target.value})},a.onChangePassword=function(e){a.setState({password:e.target.value})},a.handleLogin=function(e){e.preventDefault(),a.Auth.login(a.state.userName,a.state.password).then(function(e){if(200!==e.code)return alert(e.msg);console.log(e.msg),a.props.history.push("/"+a.state.userName),a.success()}).catch(function(e){a.error(),console.log(e)}),a.props.form.validateFields(function(e,t){e||console.log("Received values of form: ",t)})},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDillMount",value:function(){this.Auth.isLoggedIn()&&this.props.history.replace("/")}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return r.a.createElement("div",{className:"center"},r.a.createElement("div",{className:"login-card"},r.a.createElement("h1",null,"Login"),r.a.createElement(w.a,{onSubmit:this.handleLogin,className:"login-form"},r.a.createElement(ee,{onChange:this.onChangeRadio,userName:this.state.value},r.a.createElement(y.a,{value:"admin"},"Admin"),r.a.createElement(y.a,{value:"member"},"Member")),r.a.createElement(w.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(r.a.createElement(C.a,{prefix:r.a.createElement(g.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",onChange:this.onChangePassword}))),r.a.createElement(w.a.Item,null,r.a.createElement(N.a,{type:"primary",htmlType:"submit",className:"login-button"},"Log in")))))}}]),t}(n.Component),ae=w.a.create({name:"normal_login"})(te),ne=a(261),re=a.n(ne),le=a(262),oe=a.n(le),se=a(263),ie=a.n(se),ce=a(183),me=a.n(ce),ue=a(264),de=a.n(ue),he=(a(533),a(534),function(e){var t="number"!==typeof parseInt(e.value)||isNaN(parseInt(e.value))?e.value:Math.round(parseInt(e.value));return r.a.createElement("div",{className:"card mr-0 custom-card"},r.a.createElement("div",{className:"card-body"},r.a.createElement("h6",{className:"card-title mb-4 "},e.header," "),r.a.createElement("h2",{className:"mb-1 text-primary"},t),r.a.createElement("p",{className:"card-text"},r.a.createElement("small",{className:"text-muted"},e.label))))});me.a.fcRoot(re.a,oe.a,ie.a,de.a);var pe=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).chartRef=null,a.state={showChart:!1,initValue:0,flowRate:"",flowMilliLitres:"",totalMilliLitres:"",sensorName:"",dataSource:{chart:{caption:"Real Time Water Flow Rate",subCaption:"",xAxisName:"Local Time",yAxisName:"Flow Rate",numberPrefix:"L/min",refreshinterval:"2",slantLabels:"1",numdisplaysets:"10",labeldisplay:"rotate",showValues:"0",showRealTimeValue:"0",theme:"fusion"},categories:[{category:[{label:a.clientDateTime().toString()}]}],dataset:[{data:[{value:0}]}]}},a.chartConfigs={type:"realtimeline",renderAt:"container",width:"100%",height:"400",dataFormat:"json"},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.getDataFor()}},{key:"startUpdatingData",value:function(){var e=this;this.timerID=setInterval(function(){O.a.get("http://172.20.10.9:8088/react.php").then(function(t){var a=e.clientDateTime(),n=t.data.flowRate;console.log(t.data),e.chartRef.feedData("&label="+a+"&value="+n),e.setState({sensorName:t.data.sensorName,flowRate:t.data.flowRate,flowMilliLitres:t.data.flowMilliLitres,totalMilliLitres:t.data.totalMilliLitres})})},1e3)}},{key:"getDataFor",value:function(){var e=this;O.a.get("http://172.20.10.9:8088/react.php",{mode:"cors"}).then(function(t){var a=e.state.dataSource;a.chart.yAxisMaxValue=100,a.chart.yAxisMinValue=0,a.dataset[0].data[0].value=t.data.flowRate,e.setState({showChart:!0,dataSource:a,initValue:t.data.flowRate},function(){e.startUpdatingData()})})}},{key:"clientDateTime",value:function(){var e=new Date;console.log(e);var a=e.getHours();return t.addLeadingZero(a)+":"+e.getMinutes()+":"+e.getSeconds()}},{key:"getChartRef",value:function(e){this.chartRef=e}},{key:"componentWillUnmount",value:function(){clearInterval(this.timerID)}},{key:"render",value:function(){return r.a.createElement("div",{className:"row mt-5 mt-xs-4"},r.a.createElement("div",{className:"col-12 mb-3"},r.a.createElement("div",{className:"card-deck custom-card-deck"},r.a.createElement(he,{header:"Sensor Name",alt:"fireSpot",label:"(Meter Name)",value:this.state.sensorName}),r.a.createElement(he,{header:"Flow Rate",alt:"fireSpot",label:"(L/min)",value:this.state.flowRate}),r.a.createElement(he,{header:"Current Liquid Flowing",alt:"fireSpot",label:"(mL/Sec)",value:this.state.flowMilliLitres}),r.a.createElement(he,{header:"Output Liquid Quantity",alt:"fireSpot",label:"(mL)",value:this.state.totalMilliLitres}))),r.a.createElement("div",{className:"col-12"},r.a.createElement("div",{className:"card custom-card mb-5 mb-xs-4"},r.a.createElement("div",{className:"card-body"},this.state.showChart?r.a.createElement(me.a,Object.assign({},this.chartConfigs,{dataSource:this.state.dataSource,onRender:this.getChartRef.bind(this)})):null))))}}],[{key:"addLeadingZero",value:function(e){return e<=9?"0"+e:e}}]),t}(r.a.Component),fe=r.a.createElement(d.b,null,r.a.createElement(d.b.Item,null,r.a.createElement("a",{target:"_self",href:"/changepw"},"Change password"))),ge=h.a.Header,be=h.a.Content,ve=h.a.Footer,ye=new v,Ee=Object(x.f)(function(e){var t=e.history;return r.a.createElement(d.b,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["1"],selectedKeys:[t.location.pathname],style:{lineHeight:"64px"}},r.a.createElement(d.b.Item,{key:"1"},localStorage.getItem("currentUser").toUpperCase(),r.a.createElement(R.b,{to:"/".concat(localStorage.getItem("currentUser"))})))}),we=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={isAdmin:"admin"===(localStorage.getItem("currentUser")||"")},a.Success=function(){p.a.success("You are logged out from the system")},a._handleLogout=function(){ye.logout(),a.props.history.push("/login"),a.Success()},a}return Object(u.a)(t,e),Object(i.a)(t,[{key:"componentWillMount",value:function(){ye.isLoggedIn()||this.props.history.push("/login")}},{key:"render",value:function(){console.log("Rendering Appjs!");var e="admin"===(localStorage.getItem("currentUser")||"");return r.a.createElement("div",null,r.a.createElement(h.a,{className:"layout"},"/login"===this.props.location.pathname||r.a.createElement(ge,{style:{position:"fixed",zIndex:1,width:"100%"}},r.a.createElement("div",{className:"logo"},r.a.createElement("p",null,"IoT Water System")),r.a.createElement("div",{className:"logout"},r.a.createElement(y.a.Button,{value:"small",onClick:this._handleLogout},"LOGOUT",r.a.createElement(R.b,{to:"/login"}))),r.a.createElement("div",{className:"welcome"},r.a.createElement("span",null,r.a.createElement("h5",null,"Welcome!",e?r.a.createElement(f.a,{overlay:fe},r.a.createElement("a",{className:"ant-dropdown-link",href:"/changepw"},localStorage.getItem("currentUser"),r.a.createElement(g.a,{type:"down"}))):r.a.createElement("b",null,localStorage.getItem("currentUser"))))),r.a.createElement(Ee,null)),r.a.createElement(be,{style:{padding:"50px 50px"}},r.a.createElement("div",{style:{background:"#fff",padding:24,minHeight:650}},r.a.createElement(x.c,null,r.a.createElement(x.a,{path:"/changepw",component:I}),r.a.createElement(x.a,{path:"/admin",component:q}),r.a.createElement(x.a,{path:"/report",component:H}),r.a.createElement(x.a,{path:"/waterbill",component:Z}),r.a.createElement(x.a,{path:"/member",component:X}),r.a.createElement(x.a,{path:"/SensorData",component:pe})))),r.a.createElement(ve,{style:{textAlign:"center"}},"IoT Water System\xa92019 Created by ZiyuChen&&ZengyuLi"),r.a.createElement(x.a,{path:"/login",component:ae})))}}]),t}(n.Component),Ce=Object(x.f)(we);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(R.a,null,r.a.createElement("div",null,r.a.createElement(Ce,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[269,1,2]]]);
//# sourceMappingURL=main.bdb58241.chunk.js.map